# -*- coding: utf-8 -*-
import json
import os
import pytest
from agentbricks.components.internal.user_search_config_center import (
    LocalUserSearchConfigComponent,
    SearchConfigInput,
    SearchConfigOutput,
    UserSearchConfigComponent,
)


@pytest.mark.skipif(True, reason="skip all internal method")
@pytest.mark.asyncio
async def test_local_user_search_config_component_arun():
    # Initialize the component with mocked config
    current_dir = os.path.dirname(os.path.abspath(__file__))
    config = {"config_dir": current_dir}

    component = LocalUserSearchConfigComponent(config=config)
    with open(os.path.join(current_dir, "pro.json"), "r") as file:
        pro_example = json.load(file)
    component.common_search_config["pro"] = pro_example
    input_data = SearchConfigInput(strategy="pro", user_id="user_id_1")

    # Run the arun method asynchronously
    result = await component.arun(input_data)

    # Assertions
    assert isinstance(result, SearchConfigOutput)
    assert result.user_config == {}
    assert result.search_payload == pro_example["searches"]
